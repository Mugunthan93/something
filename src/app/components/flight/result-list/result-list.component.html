<ion-content>
  <ion-row>
    <ion-col>
      <mat-accordion multi="false">
        <mat-expansion-panel 
          [hideToggle]="true"  
            *ngFor="let item of (flightList | sort : (sortBy$ | async).property : (sortBy$ | async).state );let i =
            index"
            #panel>
          <mat-expansion-panel-header 
            [collapsedHeight]="'fit-content'" 
            [expandedHeight]="'fit-content'" 
            (click)="selectFlight(panel,item,$event)">
              <ion-row *ngIf="flightName" [ngClass]="{'selectedItem':item == selectedFlights,'':item !==selectedFlights}">
                <ion-label>{{item.name}}</ion-label>
                <ion-text>{{item.seats}} Seats Left</ion-text>
                <ion-text>{{item.fare | currency : item.currency}}</ion-text>
                <ion-item>
                  <ion-checkbox slot="start" class="email" [value]="item.email" (ionChange)="getFlight($event)" [checked]="emailSelect(item.email) | async"></ion-checkbox>
                  <ion-label slot="end">Email</ion-label>
                </ion-item>
              </ion-row>
              <ion-row class="ion-justify-content-around two" [ngClass]="{'selectedItem':item == selectedFlights,'':item !==selectedFlights}"
                *ngFor="let i of item.trips" [ngStyle]="{'height':'fit-content'}">
                <ion-title>
                  <ion-text>{{i.tripinfo.airline.name}} | {{i.tripinfo.airline.code}} - {{i.tripinfo.airline.number}}
                  </ion-text>
                </ion-title>
                <ion-row>
                  <ion-col>
                    <ion-img src="../../../../../../assets/AirlineLogo/{{i.tripinfo.logo}}.gif"></ion-img>
                  </ion-col>
                  <ion-col #colref [ngClass]="{'col-grow': flightType == 'return', 'col-shrink': flightType == 'departure'}">
                      <ion-text>
                        {{i.tripinfo.depTime | date : 'HH:mm'}} - {{i.tripinfo.arrTime | date : 'HH:mm'}}
                      </ion-text>
                      <ion-text>{{i.tripinfo.class}}</ion-text>
                  </ion-col>
                  <ion-col #colref [ngClass]="{'col-grow': flightType == 'return', 'col-shrink': flightType == 'departure'}">
                    <ion-text>
                      {{i.tripinfo.duration}}{{i.tripinfo.day ? '(+1Day)' : ''}}
                    </ion-text>
                    <ion-text>
                      {{i.tripinfo.stops}}
                    </ion-text>
                  </ion-col>
                  <ion-col
                    *ngIf="flightPrice">
                    <ion-text>
                      {{i.tripinfo.fare | currency : i.tripinfo.currency }}
                    </ion-text>
                    <ion-text>
                      {{i.tripinfo.seats}} seat left
                    </ion-text>
                  </ion-col>
                </ion-row>
              </ion-row>
              <ion-row *ngIf="flightMail"
                [ngClass]="{'selectedItem':item == selectedFlights,'':item !==selectedFlights}">
                <ion-checkbox class="email" [value]="item.email" (ionChange)="getFlight($event)"
                  [checked]="emailSelect(item.email) | async"></ion-checkbox>
                <ion-label>Email</ion-label>
              </ion-row>
              <ion-button slot="icon-only" class="panel-button" expand="full" size="small" (click)="rotate(i)">
                <ion-icon [@rotatedState]="state[i]" src="../../../../../../assets/ionicons/chevron-up-outline.svg">
                </ion-icon>
              </ion-button>
          </mat-expansion-panel-header>
          <ion-row class="ion-justify-content-around">
            <ion-row>
              <ion-icon name="briefcase" (click)="showBaggage(item.baggage)">
              </ion-icon>
              <ion-title>Baggage</ion-title>
            </ion-row>
            <ion-row>
              <ion-icon name="briefcase" (click)="showFareRule(item.fareRule)">
              </ion-icon>
              <ion-title>Fare Rule</ion-title>
            </ion-row>
            <ion-row>
              <ion-icon src="../../../../assets/icons/flying-fly.svg"
                (click)="showFlightDetail(item.connectingFlights)">
              </ion-icon>
              <ion-title>Flight details</ion-title>
            </ion-row>
          </ion-row>
        </mat-expansion-panel>
      </mat-accordion>
    </ion-col>
  </ion-row>
</ion-content>